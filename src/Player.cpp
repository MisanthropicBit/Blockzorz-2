#include "Player.h"
#include "Graphics.h"
#include "Color.h"
#include "Screen.h"
#include "Block.h"

//=========================================================================================================================

Player::Player()
{
	image = NULL;
	this->row = row;
	this->col = col;
	movex = 0;
	movey = 0;
	keydelay = 100;
}

//=========================================================================================================================

Player::Player(const string& file, int row, int col)
{
	Load(file, row, col);
}

//=========================================================================================================================

void Player::Load(const string& file, int row, int col)
{
	image = NULL;
	if(!file.empty())
		image = Graphics::LoadImage(file, Color::Magenta);

	this->row = row;
	this->col = col;
	movex = 0;
	movey = 0;
	keydelay = 100;
}

//=========================================================================================================================

Player::~Player()
{
	if(image)
		SDL_FreeSurface(image);

	image = NULL;
}

//=========================================================================================================================

void Player::Update(int dt)
{
/*	keydelay -= dt;

	if(keydelay <= 0)
	{
		if(col != GRID_MAX_COLUMNS && movex > 0 || col != 0 && movex < 0)
			col += movex;

		if(row != GRID_MAX_ROWS && movey > 0 || row != 0 && movey < 0)
			row += movey;

		keydelay = 100;
	}*/
}

//=========================================================================================================================

void Player::Draw()
{
	Graphics::DrawImage(image, Screen::GetScreen().GetWidth()/2 - 100 + col * BLOCK_WIDTH, row * BLOCK_HEIGHT + 50);
}

//=========================================================================================================================

void Player::SetTransparency(float alpha)
{
	Graphics::SetTransparency(image, alpha);
}

//=========================================================================================================================

int& Player::GetRow()
{
	return row;
}

//=========================================================================================================================

int& Player::GetColumn()
{
	return col;
}

//=========================================================================================================================

void Player::StartMovingUp()
{
	movey = -1;
}

//=========================================================================================================================

void Player::StartMovingDown()
{
	movey = 1;
}

//=========================================================================================================================

void Player::StartMovingLeft()
{
	movex = -1;
}

//=========================================================================================================================

void Player::StartMovingRight()
{
	movex = 1;
}

//=========================================================================================================================

void Player::StopMoving()
{
	movex = 0;
	movey = 0;
}

//=========================================================================================================================